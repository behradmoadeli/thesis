\section{Simulation Results}

This section presents numerical simulations of the closed-loop system under both full-state feedback and output-feedback model predictive control schemes. The reactor model and all physical parameters follow those in Table~\ref{tab:pars}, and the same control settings are used throughout: initial condition $c(\zeta, 0) = \sin^2(\pi \zeta)$, empty recycle stream, state and input penalty weights $Q = 0.04 I$, $F = 27$, sampling time $\Delta t = 20~\mathrm{s}$, control horizon $N = 9$, and input constraints $0 \leq u(t) \leq 0.15$. The control horizon corresponds to $180~\mathrm{s}$, which exceeds the recycle delay of $80~\mathrm{s}$. The subsections below compare the controller performance under full-state and output-feedback implementations.

\subsection{Full-State Feedback MPC Performance}

As the eigenvalue distribution obtained in Fig.~\ref{fig:eigval_dist} suggests, the open-loop system is unstable due to the presence of an eigenvalue with positive real part. The zero-input response of the system is shown in Fig.~\ref{fig:open_ACC} where the initial condition for the reactor is set to $c(\zeta ,0) = \sin^2(\pi \zeta)$. The recycle stream is assumed to be empty at the beginning of the simulation.

An infinite-dimensional MPC is designed and applied to the unstable system. The closed-loop response of the system is shown in Fig.~\ref{fig:closed_ACC} and the control input as well as the measured output is shown in Fig.~\ref{fig:input_ACC}. It may be confirmed that the MPC successfully stabilizes the unstable system while satisfying the input constraints.

\begin{figure}[!htbp]
    \centering
    \includesvg[inkscapelatex=false, width=0.65\textwidth, keepaspectratio]{papers/2_conferences/figures/openloop_response.svg}
    \caption{Open-loop concentration profile along the reactor.}
    \label{fig:open_ACC}
\end{figure}

\begin{figure}[!htbp]
    \centering
    \includesvg[inkscapelatex=false, width=0.65\textwidth, keepaspectratio]{papers/2_conferences/figures/closedloop_response_acc.svg}
    \caption{Stabilized reactor concentration profile under the proposed full-state MPC.}
    \label{fig:closed_ACC}
\end{figure}

\begin{figure}[!htbp]
    \centering
    \includesvg[inkscapelatex=false, width=0.65\textwidth, keepaspectratio]{papers/2_conferences/figures/input_acc.svg}
    \caption{Input profile and reactor output under full-state MPC, subject to constraints.}
    \label{fig:input_ACC}
\end{figure}

One interesting aspect of considering a recycle stream is the oscillatory behavior of the system dynamics. While axial dispersion reactors show no oscillation in the absence of recycle, the nature of recycle streams can introduce such behavior. The choice of control horizon is another key factor. A short control horizon relative to the residence time of the recycle stream can lead to oscillatory input profiles due to the presence of delayed recycle stream. In this example, the control horizon, i.e., $180~\mathrm{s}$, is set to be considerably longer than the recycle delay, which is $80~\mathrm{s}$; resulting in a non-oscillatory input profile.

\subsection{Observer-Based Output Feedback MPC}

To evaluate the performance of the output-feedback controller, numerical simulations are conducted under the same conditions as in the full-state feedback case. This subsection presents the closed-loop behavior of the system when using the discrete-time Luenberger observer to reconstruct the states based on output measurements.

The eigenvalue distribution shown previously in Fig.~\ref{fig:eigval_dist} confirms that the open-loop system is unstable due to the presence of an eigenvalue with a positive real part. The observer gain is selected as a constant function $L_c = 1$, and the estimated state is initialized to zero across the domain. %XXX explain gain choice if space allows

The closed-loop reactor response under the proposed output-feedback controller is shown in Fig.~\ref{fig:closed_ECC}, and the corresponding control input and measured output are shown in Fig.~\ref{fig:input_ECC}. The evolution of the state estimation error is depicted in Fig.~\ref{fig:error_ECC}. These results confirm that the observer-based MPC successfully stabilizes the unstable system while adhering to input constraints, using only output measurements.

\begin{figure}[!htbp]
    \centering
    \includesvg[inkscapelatex=false, width=0.65\textwidth, keepaspectratio]{papers/2_conferences/figures/closedloop_response.svg}
    \caption{Stabilized reactor concentration profile under the proposed observer-based MPC.}
    \label{fig:closed_ECC}
\end{figure}

\begin{figure}[!htbp]
    \centering
    \includesvg[inkscapelatex=false, width=0.65\textwidth, keepaspectratio]{papers/2_conferences/figures/input.svg}
    \caption{Input profile and reactor output under observer-based MPC.}
    \label{fig:input_ECC}
\end{figure}

\begin{figure}[!htbp]
    \centering
    \includesvg[inkscapelatex=false, width=0.65\textwidth, keepaspectratio]{papers/2_conferences/figures/observation_error.svg}
    \caption{State reconstruction error profile along the reactor.}
    \label{fig:error_ECC}
\end{figure}

An important aspect of the proposed observer-based controller is the relative speed of the observer error convergence compared to the system dynamics. As seen in Fig.~\ref{fig:error_ECC}, the observer error dynamics decay significantly faster than the closed-loop reactor response, helping prevent oscillations that may arise from poor state reconstruction.

Oscillatory behavior induced by the recycle stream is discussed at the end of the previous subsection. Since all simulation settings are shared, the same rationale applies here; the long control horizon relative to the recycle delay ensures a smooth input profile and stable closed-loop response.
